# 注解的继承

https://www.jianshu.com/p/985631b7cfc4

规则：

- 对于类：当取消`@Inherited`注解的时候，子类没有继承父类类上的注解，即：子类只能继承父类上有`@Inherite`d注解的注解；
- 对于方法：
  - 普通继承：无论注解有不有`@Inherited`，子类的方法都能继承父类方法上的注解
  - 抽象实现：无法继承父类方法上的注解
  - 方法覆盖：无法继承父类方法上的注解

即：

- `@Inherited`注解只影响类上注解的继承关系；不影响方法上注解的继承关系
- **覆盖**和抽象方法的**实现**是覆盖和**覆盖**父类的注解

父类的类上和方法上有自定义的注解，子类继承了这个父类，的情况下，有以下规则：

|                                                            | 编写自定义注解时未写`@Inherited`的运行结果： | 编写自定义注解时写了`@Inherited`的运行结果： |
| ---------------------------------------------------------- | -------------------------------------------- | -------------------------------------------- |
| 子类的类上能否继承到父类的类上的注解？                     | ❌                                            | ✔                                            |
| 子类方法，实现了父类上的抽象方法，这个方法能否继承到注解？ | ❌                                            | ❌                                            |
| 子类方法，继承了父类上的方法，这个方法能否继承到注解？     | ✔                                            | ✔                                            |
| 子类方法，覆盖了父类上的方法，这个方法能否继承到注解？     | ❌                                            | ❌                                            |

## 注解的合并

*chatgpt begin*

在 Java 中，注解的合并是指当一个元素（类、方法、字段等）上同时使用了多个注解时，这些注解的属性值可以被合并到一个整体中。这个过程是由 Java 编译器在编译时完成的。

当多个注解同时作用于同一个元素时，它们的属性值会被合并成一个新的注解，其中每个属性值的来源可以是多个注解中的一个。具体的合并规则如下：

1. 对于非数组类型的属性，如果同一个元素上存在多个相同属性名的注解，则只保留其中一个，通常是最后一个。
2. 对于数组类型的属性，将所有注解中的相同属性名的值合并成一个数组。

举个例子，假设有以下两个注解：

```java
public @interface Author {
    String name();
    String[] affiliations();
}
```

```java
public @interface Reviewer {
    String name();
    String[] comments();
}
```

如果一个方法同时使用了这两个注解：

```java
@Author(name = "Alice", affiliations = {"Company A"})
@Reviewer(name = "Bob", comments = {"Good job!"})
public void someMethod() {
    // method implementation
}
```

在这种情况下，编译器会将 `@Author` 和 `@Reviewer` 注解合并成一个新的注解，其属性值如下：

- `name` 属性：值为 "Bob"，因为 `@Reviewer` 注解在后面，所以它的值会覆盖 `@Author` 注解中的值。
- `affiliations` 属性：值为 {"Company A"}，因为 `@Author` 注解中的属性是数组类型，所以会将两个注解中的值合并成一个数组。

合并后的结果相当于：

```java
@CombinedAnnotation(name = "Bob", affiliations = {"Company A"})
public void someMethod() {
    // method implementation
}
```

这个新的合并注解不是真正存在的，但可以用来理解编译器处理注解的方式。

*chatgpt end*

